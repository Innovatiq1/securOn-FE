<div *ngIf="vulnerabilityDataService.loading$ | async" class="mat-loader-overlay">
    <mat-spinner></mat-spinner>
  </div>

<mat-card class="cardWithShadow">
    <mat-card-content class="p-24">
        <div style="margin: 15px;">
            <span class="f-s-20 f-w-700">
                Search CVE's
            </span>
            <span class="search">
                Dashboard
            </span>
            <span class="-copy">
                /
            </span>
            <span class="search">
                Search
            </span>
            <span class="-copy">
                /
            </span>
            <span class="mx-2 f-s-13">
                CVE - ID View
            </span>

        </div>
        <div class="text-center pt-4">
            <h5>View CVE Details</h5>
            <hr>
        </div>
        <mat-card class="cardWithShadow">
            <mat-card-content class="p-24">
                <div style="float: right;">
                    <button mat-raised-button color="warn" (click)="_backToList()">Back</button>
                </div>

                <div>
                    <h3>Vulnerability Details: <span class="highlight-text" style="font-style: italic;" >{{data[0]?.cve?.id}}</span></h3>
                    <h4 class="mt-3">Published: <span class="f-s-13" style="font-weight: lighter;">{{data[0]?.cve?.published}}</span></h4>
                    <h4 class="mt-3">Updated: <span class="f-s-13" style="font-weight: lighter;">{{data[0]?.cve?.lastModified}}</span></h4>
                    <h4 class="mt-3">Source: <span class="f-s-13" style="font-weight: lighter;">{{data[0]?.cve?.sourceIdentifier}}</span></h4>
                    <h4 class="mt-3">Description: <span class="f-s-13" style="font-weight: lighter;">{{data[0]?.cve?.descriptions[0]?.value}}</span></h4>

                </div>
                <h4 class="mt-5">CVSS scores for <span>{{data.vulnerability?.cve?.id}}</span></h4>
                <div class="row mt-4">
                    <div class="col-4">
                        <h4>Base Score:
                            <app-score-chip [score]="data[0]?.cve?.metrics | baseScore"></app-score-chip>
                        </h4>
                    </div>
                    <div class="col-4">
                        <h4>Exploitability Score:
                            <app-score-chip [score]="data[0]?.cve?.metrics | cvssAttribute:'exploitabilityScore'"></app-score-chip>
                        </h4>
                    </div>
                    <div class="col-4">
                        <h4>Impact Score:
                            <app-score-chip [score]="data[0]?.cve?.metrics | cvssAttribute:'impactScore'"></app-score-chip>
                        </h4>
                    </div>
                    
                </div>
                <div class="row mt-3">
                    <div class="col-4">
                        <h4>Base Severity:   {{data[0]?.cve?.metrics | cvssAttribute: 'baseSeverity'}}
                        </h4>
                    </div>
                    <div class="col-4">
                        <h4>Source: {{ data[0]?.cve?.metrics | cvssAttribute:'source'}}
                        </h4>
                    </div>
                </div>
                
                <h4 class="mt-5">CVSS References for <span>{{data.vulnerability?.cve?.id}}</span></h4>
                <div *ngFor="let reference of data[0]?.cve?.references">
                    <a class="highlight-text" [href]="reference?.url">{{reference?.url}}</a>
                </div>
               
                </mat-card-content>
                </mat-card>

               
    </mat-card-content>
</mat-card>
